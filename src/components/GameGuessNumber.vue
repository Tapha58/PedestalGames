<template>
    <div>
        <ChoicePrize v-model="gameData"></ChoicePrize>
        <MakeNumber v-model="gameData"></MakeNumber>
        <Rules v-model="gameData"></Rules>
        <PostSettings v-model="gameData"></PostSettings>
        <ImagePost v-model="gameData"></ImagePost>
        <TimePost></TimePost>
        <AdvancedSettings v-model="gameData"></AdvancedSettings>
    </div>
</template>

<script>
    import ChoicePrize from '@/components/–°hoicePrize.vue';
    import MakeNumber from '@/components/MakeNumber.vue';
    import Rules from '@/components/Rules.vue';
    import PostSettings from '@/components/PostSettings.vue';
    import ImagePost from '@/components/ImagePost.vue';
    import TimePost from '@/components/TimePost.vue';
    import AdvancedSettings from '@/components/AdvancedSettings.vue';

    export default {
        name: "GuessNumber",
        components: {
            ChoicePrize, MakeNumber, Rules, PostSettings, ImagePost, AdvancedSettings, TimePost,
        },
        data: () => ({
            gameData: {
                "game": {
                    "id_group_vk": 106581421,
                    "id_post_vk": 956,
                    "is_active": true,
                    "post_publication_date": "2020-05-12T22:59:44+03:00",
                    "is_random_giveaway": false,
                    "winner_max": 0,
                    "free_attempts_count": 0,
                    "paid_attempts_count": 0,
                    "paid_attempt_price": 0,
                    "balance_type": null,
                    "required_join_group": null,
                    "required_enable_notifications": null,
                    "required_repost": false,
                    "required_join_partner_group": null,
                    "join_group_count_attempts": 0,
                    "enable_notifications_count_attempts": 0,
                    "repost_count_attempts": 0,
                    "join_partner_group_count_attempts": 0,
                    "partner_group_id": null,
                    "attempts_interval": 0,
                    "attempts_extended_count": 0,
                    "attempts_extended_frequency_minutes": 0,
                    "attempts_extended_max_count": 0,
                    "start_date": "2020-05-12T18:59:44+03:00",
                    "end_date": null,
                    "partner_group_members_start": null,
                    "group_members_start": 0,
                    "disable_comments_after_end": true,
                    "win_per_participant_limit": 0,
                    "message_win": "{profile}, –ø–æ–∑–¥—Ä–∞–≤–ª—è–µ–º, –í—ã –≤—ã–∏–≥—Ä–∞–ª–∏! {—Ç–µ–∫—Å—Ç –ø—Ä–∏–∑–∞} {–Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ_–Ω–∞_–±–∞–ª–∞–Ω—Å} {–Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞} {API}.",
                    "message_win_balance": "–ù–∞ –±–∞–ª–∞–Ω—Å –∑–∞—á–∏—Å–ª–µ–Ω–æ {count_win_balance) {balance_name}.",
                    "message_win_rating": "–ù–∞ —Ä–µ–π—Ç–∏–Ω–≥ –∑–∞—á–∏—Å–ª–µ–Ω–æ {count_win_rating} {rating_name}",
                    "message_win_API": "Win api",
                    "message_win_API_fail": "Api fail",
                    "message_already_win": "{profile}, –≤—ã —É–∂–µ –≤—ã–∏–≥—Ä–∞–ª–∏ –≤ —ç—Ç–æ–π –∏–≥—Ä–µ.",
                    "message_attempts_timeout": "{profile}, —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —á–µ—Ä–µ–∑ {timeout}.",
                    "message_invalid_format": "{profile}, –Ω–µ–≤–µ—Ä–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç —Å–æ–æ–±—â–µ–Ω–∏—è.",
                    "message_game_end": "{profile}, –∏–≥—Ä–∞ —É–∂–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –ß–∏—Å–ª–æ —É–≥–∞–¥–∞–Ω–æ, –∞ –º–æ–∂–µ—Ç –∏ –Ω–µ—Ç.",
                    "message_comment_edited": "{profile}, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –Ω–µ —É—á–∏—Ç—ã–≤–∞—é—Ç—Å—è. –ù–∞–ø–∏—à–∏—Ç–µ –Ω–æ–≤—ã–π.",
                    "message_requirement_violated": "{profile}, –í—ã –Ω–µ –≤—ã–ø–æ–ª–Ω–∏–ª–∏ —Å–ª–µ–¥—É—é—â–µ–µ —É—Å–ª–æ–≤–∏–µ –¥–ª—è —É—á–∞—Å—Ç–∏—è: {fail_conditions}.",
                    "message_has_attempts": "—É –í–∞—Å –æ—Å—Ç–∞–ª–æ—Å—å –ø–æ–ø—ã—Ç–æ–∫: {count_attempts}",
                    "message_attempts_out": "—É –í–∞—Å –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å –ø–æ–ø—ã—Ç–∫–∏",
                    "message_attempts_can_be_bought": "—É –í–∞—Å –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å –ø–æ–ø—ã—Ç–∫–∏, –Ω–æ –í—ã –º–æ–∂–µ—Ç–µ –∫—É–ø–∏—Ç—å –µ—â–µ {count_can_pay_attempts) –ø–æ–ø—ã—Ç–æ–∫",
                    "message_attempts_can_be_extended": "–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –±—É–¥—É—Ç –Ω–∞—á–∏—Å–ª–µ–Ω—ã —á–µ—Ä–µ–∑ {next_attempts_periodic} –≤ –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ: {count_attempts_periodic}—à—Ç.",
                    "message_attempts_can_be_added": "–í—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –∑–∞ {action_for_attempts}.",
                    "message_not_available_attempts": "—É –í–∞—Å –∑–∞–∫–æ–Ω—á–∏–ª–∏—Å—å –≤—Å–µ –ø–æ–ø—ã—Ç–∫–∏. –ò–≥—Ä–∞ –¥–ª—è –í–∞—Å –∑–∞–≤–µ—Ä—à–µ–Ω–∞.",
                    "message_private_profile": "{profile}, –Ω–µ —É–¥–∞–ª–æ—Å—å –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ä–µ–ø–æ—Å—Ç–∞ –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–≤–∞—Ç–Ω–æ—Å—Ç–∏.",
                    "message_bought_max_attempts": "{profile}, –í—ã —É–∂–µ –∫—É–ø–∏–ª–∏ –≤—Å–µ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –ø–ª–∞—Ç–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏. –ë–æ–ª—å—à–µ –∫—É–ø–∏—Ç—å –Ω–µ–ª—å–∑—è.",
                    "message_wants_too_many_attempts": "{profile}, –í—ã –ø—ã—Ç–∞–µ—Ç–µ—Å—å –∫—É–ø–∏—Ç—å —Å–ª–∏—à–∫–æ–º –º–Ω–æ–≥–æ –ø–æ–ø—ã—Ç–æ–∫. –î–æ—Å—Ç—É–ø–Ω–æ –¥–ª—è –ø–æ–∫—É–ø–∫–∏: {count_can_pay_attempts).",
                    "message_not_enough_money": "{profile}, –Ω–µ —Ö–≤–∞—Ç–∞–µ—Ç —Ä–µ—Å—É—Ä—Å–æ–≤ –¥–ª—è –ø–æ–∫—É–ø–∫–∏.",
                    "message_successful_buy": "{profile}, —É—Å–ø–µ—à–Ω–∞—è –ø–æ–∫—É–ø–∫–∞! –î–æ—Å—Ç—É–ø–Ω–æ –ø–æ–ø—ã—Ç–æ–∫ {count_attempts}. –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –±–∏—Ç–≤—É!",
                    "repost_desc": "—Ä–µ–ø–æ—Å—Ç —ç—Ç–æ–≥–æ –ø–æ—Å—Ç–∞",
                    "join_group_desc": "–≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ –≤ –Ω–∞—à—É –≥—Ä—É–ø–ø—É",
                    "join_partner_group_desc": "–≤—Å—Ç—É–ø–ª–µ–Ω–∏–µ –≤ –ø–∞—Ä—Ç–Ω—ë—Ä—Å–∫—É—é –≥—Ä—É–ø–ø—É {external}",
                    "enable_notifications_desc": "—Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ –ø–æ–ª—É—á–∞—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –æ—Ç –Ω–∞—à–µ–≥–æ —Å–æ–æ–±—â–µ—Å—Ç–≤–∞"
                },
                "prizes": [],
                "prizes_front": [
                    {
                    id: 1,
                    prize_count: 1,
                    prizes: [{type: 'own_prize'}]
                }
                ],
                'auth_data': null,
                'image': null,
                'min_number': '',
                "max_number": '',
                "guessed_number": '',
                "message_number_greater": "Greather",
                "message_number_less": "Less",
                'post_text':
                    "–£ –Ω–∞—Å –∫–æ–Ω–∫—É—Ä—Å üéÅ\n" +
                    "–ú—ã –∑–∞–≥–∞–¥–∞–ª–∏ —á–∏—Å–ª–æ –æ—Ç {min} –¥–æ {max}. –£–≥–∞–¥–∞–≤—à–∏–π –ø–æ–ª—É—á–∏—Ç –ø—Ä–∏–∑.\n" +
                    "–ü—Ä–∞–≤–∏–ª–∞ –∫–æ–Ω–∫—É—Ä—Å–∞: –≤–∞–º –Ω—É–∂–Ω–æ —É–≥–∞–¥–∞—Ç—å —á–∏—Å–ª–æ, –∫–æ—Ç–æ—Ä–æ–µ –º—ã –∑–∞–≥–∞–¥–∞–ª–∏. –î–ª—è —ç—Ç–æ–≥–æ –≤ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è—Ö –ø–æ–¥ —ç—Ç–∏–º –ø–æ—Å—Ç–æ–º –Ω–∞–ø–∏—à–∏—Ç–µ –≤–∞—à –≤–∞—Ä–∏–∞–Ω—Ç. –ù–∞–ø—Ä–∏–º–µ—Ä, !15.\n" +
                    "–ù–∞—à –±–æ—Ç –≤ –æ—Ç–≤–µ—Ç–Ω–æ–º —Å–æ–æ–±—â–µ–Ω–∏–∏ —Å–æ–æ–±—â–∏—Ç –≤–∞–º —É–≥–∞–¥–∞–ª–∏ –≤—ã –∏–ª–∏ –Ω–µ—Ç.\n" +
                    "–ö–∞–∂–¥—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ –∏–º–µ–µ—Ç 3 –ø–æ–ø—ã—Ç–∫–∏ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º –∏–Ω—Ç–µ—Ä–≤–∞–ª–æ–º –≤ 1 –º–∏–Ω—É—Ç—É.\n" +
                    "–ß—Ç–æ–±—ã —É—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å –≤—Å—Ç—É–ø–∏—Ç–µ –≤ –Ω–∞—à—É –≥—Ä—É–ø–ø—É –∏ —Å–¥–µ–ª–∞–π—Ç–µ —Ä–µ–ø–æ—Å—Ç —ç—Ç–æ–π –∑–∞–ø–∏—Å–∏.\n" +
                    "–ü—Ä–æ–≤–µ—Ä–∏—Ç—å –±–æ—Ç–∞ –Ω–∞ —á–µ—Å—Ç–Ω–æ—Å—Ç—å: {—Å—Å—ã–ª–∫–∞}",

                required_join_group_abc: '',
                required_repost_abc: '',
                required_enable_notifications_abc: '',
                required_join_partner_group_abc: '',
                show_attempts_extended: null,
                switchPaidAttempts: false,
                delayedLaunch: false,
            },
            def_settings: null,
        }),
        created:
            function () {

            },
        mounted:
            async function () {
                await this.load_def_settings ()
                await this.load_def_settings_guess_number()
                this.apply_def_settings()
            },
        methods: {
            apply_def_settings: function () {
                console.log('apply_def_settings')
                if (this.gameData.game.required_join_group === false && this.gameData.game.join_group_count_attempts === 0)
                    this.gameData.required_join_group_abc = 'a'
                if (this.gameData.game.required_join_group === true)
                    this.gameData.required_join_group_abc = 'b'
                if (this.gameData.game.required_join_group === false && this.gameData.game.join_group_count_attempts > 0)
                    this.gameData.required_join_group_abc = 'c'

                if (this.gameData.game.required_enable_notifications === false && this.gameData.game.enable_notifications_count_attempts === 0)
                    this.gameData.required_enable_notifications_abc = 'a'
                if (this.gameData.game.required_enable_notifications === true)
                    this.gameData.required_enable_notifications_abc = 'b'
                if (this.gameData.game.required_enable_notifications === false && this.gameData.game.enable_notifications_count_attempts > 0)
                    this.gameData.required_enable_notifications_abc = 'c'

                if (this.gameData.game.required_repost === false && this.gameData.game.repost_count_attempts === 0)
                    this.gameData.required_repost_abc = 'a'
                if (this.gameData.game.required_repost === true)
                    this.gameData.required_repost_abc = 'b'
                if (this.gameData.game.required_repost === false && this.gameData.game.repost_count_attempts > 0)
                    this.gameData.required_repost_abc = 'c'

                if (this.gameData.game.required_join_partner_group === false && this.gameData.game.repost_count_attempts === 0)
                    this.gameData.required_join_partner_group_abc = 'a'
                if (this.gameData.game.required_join_partner_group === true)
                    this.gameData.required_join_partner_group_abc = 'b'
                if (this.gameData.game.required_join_partner_group === false && this.gameData.game.repost_count_attempts > 0)
                    this.gameData.required_join_partner_group_abc = 'c'

                if (this.gameData.game.join_partner_group_count_attempts !== 0)
                    this.gameData.show_attempts_extended = true
            },
            load_def_settings: async function () {
                console.log('load_def_settings')
                let response = await fetch("https://pedestal-test2.aiva-studio.ru/app/wallgames/default_settings/1")
                if (response.ok) {
                    this.gameData.game = await response.json()
                    console.log('all ok')
                }
                else {
                    console.log("–û—à–∏–±–∫–∞ HTTP: " + response.status)
                }
            },
            load_def_settings_guess_number: async function () {
                let response = await fetch("https://pedestal-test2.aiva-studio.ru/app/wallgames/guess_number/default_settings")
                if (response.ok) {
                    this.def_settings1 = await response.json()
                    console.log('all ok')
                }
                else {
                    console.log("–û—à–∏–±–∫–∞ HTTP: " + response.status)
                }
            }
        },
    }
</script>

<style scoped>

</style>